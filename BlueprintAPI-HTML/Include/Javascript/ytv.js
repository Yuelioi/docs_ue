(function(n,t){"use strict";var i=i||function(i,r){var h=function(){},u={width:"100%",async:!0,videoid:null,element:null,user:null,fullscreen:!1,accent:"#fff",controls:!0,annotations:!1,autoplay:!1,chainVideos:!0,browsePlaylists:!1,wmode:"opaque",events:{videoReady:h,stateChange:h}},s={},f={events:{addEvent:function(n,t,i){return n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent?n.attachEvent("on"+t,i):void 0},removeEvent:function(n,t,i){return n.addEventListener?n.removeEventListener(t,i,!1):n.attachEvent?n.detachEvent("on"+t,i):void 0},prevent:function(n){n.preventDefault?n.preventDefault():n.returnValue=!1}},addCSS:function(n){var r=t.getElementsByTagName("head")[0],i=t.createElement("style");i.type="text/css";i.styleSheet?i.styleSheet.cssText=n:i.appendChild(t.createTextNode(n));r.appendChild(i)},addCommas:function(n){for(var i=n.split("."),t=i[0],u=i.length>1?"."+i[1]:"",r=/(\d+)(\d{3})/;r.test(t);)t=t.replace(r,"$1,$2");return t+u},parentUntil:function(n,t){while(n.parentNode){if(n.getAttribute&&n.getAttribute(t))return n;n=n.parentNode}return null},ajax:{get:function(t,i){var r;r=n.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){r.readyState===4&&r.status===200&&i.call(this,JSON.parse(r.responseText))};r.open("GET",t,!0);r.send()}},endpoints:{base:"https://gdata.youtube.com/",userInfo:function(){return f.endpoints.base+"feeds/api/users/"+u.user+"?v=2&alt=json"},userVids:function(){return f.endpoints.base+"feeds/api/users/"+u.user+"/uploads/?v=2&alt=json&format=5&max-results=50"},userPlaylists:function(){return f.endpoints.base+"feeds/api/users/"+u.user+"/playlists/?v=2&alt=json&format=5&max-results=50"},playlistVids:function(){return f.endpoints.base+"feeds/api/playlists/"+u.playlist+"?v=2&alt=json&format=5&max-results=50"}},deepExtend:function(n,t){for(var i in t)t[i]&&t[i].constructor&&t[i].constructor===Object?(n[i]=n[i]||{},f.deepExtend(n[i],t[i])):n[i]=t[i];return n}},o={youtube:function(i){var u=t.createElement("script"),r;u.src="https://www.youtube.com/iframe_api";r=t.getElementsByTagName("script")[0];r.parentNode.insertBefore(u,r);n.onYouTubeIframeAPIReady=i},build:function(){u.element.className="ytv-canvas";u.fullscreen&&(u.element.className+=" ytv-full");f.addCSS(".ytv-list .ytv-active a{border-left-color: "+u.accent+";}")},playlists:function(n){var i,u,r,f,o,e;if(n&&n.feed){for(i='<div class="ytv-playlists"><ul>',u=n.feed.entry,r=0;r<u.length;r++)f={title:u[r].title.$t,plid:u[r].yt$playlistId.$t,thumb:u[r].media$group.media$thumbnail[1].url},i+='<a href="#" data-ytv-playlist="'+f.plid+'">',i+='<div class="ytv-thumb"><div class="ytv-thumb-stroke"><\/div><img src="'+f.thumb+'"><\/div>',i+="<span>"+f.title+"<\/span>",i+="<\/a>";i+="<\/ul><\/div>";o=t.getElementsByClassName("ytv-list-header")[0];e=o.children[0];e.href="#";e.target="";e.setAttribute("data-ytv-playlist-toggle","true");t.getElementsByClassName("ytv-list-header")[0].innerHTML+=i;o.className+=" ytv-has-playlists"}},compileList:function(n){n&&n.feed&&f.ajax.get(f.endpoints.userInfo(),function(t){var c="",h={title:t.entry.title.$t,url:"http://youtube.com/user/"+t.entry.yt$username.$t,thumb:t.entry.media$thumbnail.url,summary:t.entry.summary.$t,subscribers:t.entry.yt$statistics.subscriberCount,views:t.entry.yt$statistics.totalUploadViews},r=n.feed.entry,l=!0,i,k,a,b,d,s,g,w;if(u.playlist&&(h.title=n.feed.media$group.media$title.$t,h.description=n.feed.media$group.media$description.$t,h.categories=[],h.description.indexOf("Categories:")!=-1))for(k=h.description.substring(h.description.indexOf("Categories:")+11).split(","),i=0;i<k.length;i++)h.categories.push(k[i].trim());a='<div class="ytv-list-header">';a+='<a href="'+h.url+'" target="_blank">';a+='<img src="'+h.thumb+'">';a+="<\/a>";a+="<\/div>";$("#user_info").html(a);b=document.createElement("DIV");b.id="videoinfo";b.innerHTML='<div id="user-controls" style="position;relative;overflow:hidden;background:#e2e3e4;"><\/div><div class="ytv-video-description" id="videodescription"><\/div><div id="video-list-container" style="margin:1em 0em 0em;"><div class="link_list_title" id="video-list-title"><\/div><div id="video-list" style="position;relative;"><\/div><\/div>';u.element.parentNode.insertBefore(b,u.element.nextSibling);$("#user-controls").html('<div class="ytv-button chain" onclick="toggleChaining();" title="Click to Toggle Video Chaining"><\/div><div class="ytv-button next"><\/div><div class="ytv-button prev"><\/div>');d=readCookie("video_chain");d!=null&&(d=="true"?($(".ytv-button.chain").addClass("enabled"),u.chainVideos=!0):u.chainVideos=!1);u.element.style.width=u.width;c+='<div class="ytv-list-inner"><ul>';var y="",p="",v=u.videoid;for(i=0;i<r.length;i++)if(r[i].media$group.yt$duration){s={title:r[i].title.$t,description:r[i].media$group.media$description.$t,slug:r[i].media$group.yt$videoid.$t,link:r[i].link[0].href,published:r[i].published.$t,rating:r[i].yt$rating,stats:r[i].yt$statistics,duration:r[i].media$group.yt$duration.seconds,thumb:r[i].media$group.media$thumbnail[1].url};g=new Date(null);g.setSeconds(s.duration);var tt=g.toTimeString().substr(0,8).split(":"),it=tt[1]+":"+tt[2],nt="";u.videoid==null&&l===!0?(v=s.slug,nt=' class="ytv-active"',l=s,$(".ytv-button.prev").addClass("disabled")):u.videoid&&s.slug==v&&(i==r.length-1?$(".ytv-button.next").addClass("disabled"):i==0&&$(".ytv-button.prev").addClass("disabled"),nt=' class="ytv-active"',l=s);i!=0&&v&&s.slug==v&&(y={title:r[i-1].title.$t,description:r[i-1].media$group.media$description.$t,slug:r[i-1].media$group.yt$videoid.$t,link:r[i-1].link[0].href,published:r[i-1].published.$t,rating:r[i-1].yt$rating,stats:r[i-1].yt$statistics,duration:r[i-1].media$group.yt$duration.seconds,thumb:r[i-1].media$group.media$thumbnail[1].url},$(".ytv-button.prev").html('<a href="../Player/index.html?series='+u.playlist+"&video="+y.slug+'" data-ytv-title="'+y.title+'" data-ytv="'+y.slug+'" title="'+y.title+'" class="ytv-clear">'));i!=r.length-1&&v&&s.slug==v&&(p={title:r[i+1].title.$t,description:r[i+1].media$group.media$description.$t,slug:r[i+1].media$group.yt$videoid.$t,link:r[i+1].link[0].href,published:r[i+1].published.$t,rating:r[i+1].yt$rating,stats:r[i+1].yt$statistics,duration:r[i+1].media$group.yt$duration.seconds,thumb:r[i+1].media$group.media$thumbnail[1].url},$(".ytv-button.next").html('<a href="../Player/index.html?series='+u.playlist+"&video="+p.slug+'" data-ytv-title="'+p.title+'" data-ytv="'+p.slug+'" title="'+p.title+'" class="ytv-clear">'));c+="<li"+nt+'><a href="../Player/index.html?series='+u.playlist+"&video="+s.slug+'" data-ytv-title="'+s.title+'" data-ytv="'+s.slug+'" title="'+s.description+'" class="ytv-clear">';c+='<div class="ytv-content"><b>'+s.title+"<\/b>";s.stats&&c+'<\/b><span class="ytv-views">'+f.addCommas(s.stats.viewCount)+" Views<\/span>";c+="<\/div><\/a><\/li>"}if(c+="<\/ul><\/div>",u.element.innerHTML='<div class="ytv-video"><div id="ytv-video-player"><\/div><\/div>',$("#video-list").html('<div class="ytv-list">'+c+"<\/div>"),w="",h.categories.length>0){for(w+='<div style="float:right;margin-left:8px;">',i=0;i<h.categories.length;i++)w+='<div class="ytv-button category"><a href="../../Videos/index.html?category='+h.categories[i]+'">'+h.categories[i]+"<\/a><\/div>";w+="<\/div>"}$("#video-list-title").html(h.title+w);e.logic.loadVideo(l.slug,u.autoplay,l.title,l.description);u.browsePlaylists&&f.ajax.get(f.endpoints.userPlaylists(),o.playlists)})}},e={logic:{playerStateChange:function(n){console.log(n)},loadVideo:function(n,i,r,f){var e=t.getElementsByClassName("ytv-video")[0];e.innerHTML='<div id="ytv-video-player"><\/div>';$("title").html(r);$("h1").html(r);$("#crumbs_page_title").html(r);$(".ytv-video-description").html(replaceLineBreaks(replaceURL(f)));s.player=new YT.Player("ytv-video-player",{videoId:n,events:{onReady:function(n){n.target.setPlaybackQuality("hd1080");u.events.videoReady.call(this,n)},onStateChange:function(n){var i=readCookie("video_chain"),r,f;i!=null&&(u.chainVideos=i=="true"?!0:!1);n.target.getPlayerState()===0&&u.chainVideos&&(r=t.getElementsByClassName("ytv-active")[0].nextSibling,f=r.children[0],f.click());n.data==YT.PlayerState.BUFFERING&&n.target.setPlaybackQuality("hd1080");u.events.stateChange.call(this,n)}},playerVars:{autohide:1,modestbranding:1,enablejsapi:1,origin:t.domain,controls:u.controls?1:0,rel:0,showinfo:0,iv_load_policy:u.annotations?"":3,autoplay:i?1:0,wmode:u.wmode}})}},endpoints:{videoClick:function(n){var i,o,r;if(u.async&&(i=f.parentUntil(n.target?n.target:n.srcElement,"data-ytv"),i&&i.getAttribute("data-ytv"))){for(f.events.prevent(n),o=t.getElementsByClassName("ytv-active"),r=0;r<o.length;r++)o[r].className="";i.parentNode.className="ytv-active";e.logic.loadVideo(i.getAttribute("data-ytv"),!0,i.getAttribute("data-ytv-title"),i.getAttribute("title"))}},playlistToggle:function(n){var r=f.parentUntil(n.target?n.target:n.srcElement,"data-ytv-playlist-toggle"),i;r&&r.getAttribute("data-ytv-playlist-toggle")&&(f.events.prevent(n),i=t.getElementsByClassName("ytv-list-header")[0],i.className.indexOf("ytv-playlist-open")===-1?i.className+=" ytv-playlist-open":i.className=i.className.replace(" ytv-playlist-open",""))},playlistClick:function(n){var i=f.parentUntil(n.target?n.target:n.srcElement,"data-ytv-playlist");i&&i.getAttribute("data-ytv-playlist")&&(f.events.prevent(n),u.playlist=i.getAttribute("data-ytv-playlist"),i.children[1].innerHTML="Loading...",f.ajax.get(f.endpoints.playlistVids(),function(n){var i=t.getElementsByClassName("ytv-list-header")[0];i.className=i.className.replace(" ytv-playlist-open","");o.compileList(n)}))}},loadAds:function(){f.ajax.get(f.endpoints.adPlaylist(),function(n){var i=n.feed.entry,t;for(s.ads=[],t=0;t<i.length;t++)s.ads.push({title:i[t].title.$t,slug:i[t].media$group.yt$videoid.$t,duration:parseInt(i[t].media$group.yt$duration.seconds,10)})})},bindEvents:function(){f.events.addEvent(u.element,"click",e.endpoints.videoClick);f.events.addEvent(u.element,"click",e.endpoints.playlistToggle);f.events.addEvent(u.element,"click",e.endpoints.playlistClick)}},c=function(n,i){f.deepExtend(u,i);u.element=typeof n=="string"?t.getElementById(n):n;u.element&&u.user&&o.youtube(function(){o.build();e.bindEvents();f.ajax.get(u.playlist?f.endpoints.playlistVids():f.endpoints.userVids(),o.compileList)})};this.destroy=function(){f.events.removeEvent(u.element,"click",e.endpoints.videoClick);f.events.removeEvent(u.element,"click",e.endpoints.playlistToggle);f.events.removeEvent(u.element,"click",e.endpoints.playlistClick);u.element.className="";u.element.innerHTML=""};this.fullscreen={state:function(){return u.element.className.indexOf("ytv-full")!==-1},enter:function(){u.element.className.indexOf("ytv-full")===-1&&(u.element.className+="ytv-full")},exit:function(){u.element.className.indexOf("ytv-full")!==-1&&(u.element.className=u.element.className.replace("ytv-full",""))}};c(i,r)};typeof module!="undefined"&&module.exports&&(module.exports=i);typeof ender=="undefined"&&(this.YTV=i);typeof define=="function"&&define.amd&&define("YTV",[],function(){return i});typeof jQuery!="undefined"&&jQuery.fn.extend({ytv:function(n){return this.each(function(){new i(this,n)})}})}).call(this,window,document)